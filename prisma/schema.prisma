generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum UserStatus {
  PENDING
  ACTIVE
  INACTIVE
}

model User {
  id                        Int                           @id @default(autoincrement())
  email                     String                        @unique
  isEmailConfirmed          Boolean                       @default(false)
  phoneNumber               String                        @unique
  isPhoneNumberConfirmed    Boolean                       @default(false)
  password                  String
  status                    UserStatus                    @default(PENDING)
  isAdmin                   Boolean                       @default(false)
  isContentCreator          Boolean                       @default(false)
  contentCreator            ContentCreator?               
  watchLaters               UserMovieWatchLater[]
  premieringMoviesPurchases UserPremieringMoviePurchase[]
  subscriptionPackage       UserSubscriptionPackage?
  privateFiles              PrivateFile[]
  publicFiles               PublicFile[]
  createdAt                 DateTime                      @default(now())
  updatedAt                 DateTime                      @updatedAt
}

model ContentCreator {
  id           Int           @id @default(autoincrement())
  user         User         @relation(fields: [userId], references: [id])
  userId       Int          @unique
  SingleMovies SingleMovie[]
  seriesMovies SeriesMovie[]
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
}

model PrivateFile {
  id        Int      @id @default(autoincrement())
  key       String   @unique
  owner     User     @relation(fields: [ownerId], references: [id])
  ownerId   Int
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model PublicFile {
  id        Int      @id @default(autoincrement())
  url       String   @unique
  key       String   @unique
  owner     User     @relation(fields: [ownerId], references: [id])
  ownerId   Int
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Genre {
  id           Int           @id @default(autoincrement())
  name         String        @unique
  singleMovies SingleMovie[]
  seriesMovies SeriesMovie[]
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
}

model Language {
  id           Int           @id @default(autoincrement())
  name         String        @unique
  singleMovies SingleMovie[]
  seriesMovies SeriesMovie[]
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
}

model SingleMovie {
  id                      Int                           @id @default(autoincrement())
  title                   String
  description             String
  duration                String
  posterUrl               String
  trailerUrl              String
  videoUrl                String
  filesFolder             String?
  isPremiering            Boolean                       @default(false)
  price                   String
  userPremieringPurchases UserPremieringMoviePurchase[]
  views                   Int                           @default(0)
  genres                  Genre[]
  languages               Language[]
  contentCreator          ContentCreator                @relation(fields: [contentCreatorId], references: [id])
  contentCreatorId        Int
  userWatchLaters         UserMovieWatchLater[]
  createdAt               DateTime                      @default(now())
  updatedAt               DateTime                      @updatedAt
}

model SeriesMovie {
  id               Int                   @id @default(autoincrement())
  title            String
  description      String
  posterUrl        String
  trailerUrl       String
  isPremiering     Boolean               @default(false)
  views            Int                   @default(0)
  seasons          Season[]
  genres           Genre[]
  languages        Language[]
  contentCreator   ContentCreator        @relation(fields: [contentCreatorId], references: [id])
  contentCreatorId Int
  userWatchLater   UserMovieWatchLater[]
  createdAt        DateTime              @default(now())
  updatedAt        DateTime              @updatedAt
}

model Season {
  id                      Int                           @id @default(autoincrement())
  title                   String
  description             String
  posterUrl               String
  trailerUrl              String
  isPremiering            Boolean                       @default(false)
  price                   String
  views                   Int                           @default(0)
  userPremieringPurchases UserPremieringMoviePurchase[]
  episodes                Episode[]
  seriesMovie             SeriesMovie                   @relation(fields: [seriesMovieId], references: [id])
  seriesMovieId           Int                   
  createdAt               DateTime                      @default(now())
  updatedAt               DateTime                      @updatedAt
}

model Episode {
  id          Int      @id @default(autoincrement())
  number      Int
  title       String
  description String
  duration    String
  posterUrl   String
  trailerUrl  String
  videoUrl    String
  views       Int      @default(0)
  season      Season   @relation(fields: [seasonId], references: [id])
  seasonId    Int
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model UserMovieWatchLater {
  id           Int           @id @default(autoincrement())
  user         User          @relation(fields: [userId], references: [id])
  userId       Int
  singleMovies SingleMovie[]
  seriesMovies SeriesMovie[]
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
}

model UserPremieringMoviePurchase {
  id                 Int           @id @default(autoincrement())
  user               User          @relation(fields: [userId], references: [id])
  userId             Int
  singleMovies       SingleMovie[]
  seriesMovieSeasons Season[]
  createdAt          DateTime      @default(now())
  updatedAt          DateTime      @updatedAt
}

enum PackageName {
  BASIC
  STANDARD
  PREMIUM
  PLATINUM
}

model SubscriptionPackage {
  id                Int                       @id @default(autoincrement())
  name              PackageName
  description       String
  duration          Int
  price             String
  createdAt         DateTime                  @default(now())
  updatedAt         DateTime                  @updatedAt
  userSubscriptions UserSubscriptionPackage[]
}

model UserSubscriptionPackage {
  id                    Int                 @id @default(autoincrement())
  subscriptionPackage   SubscriptionPackage @relation(fields: [subscriptionPackageId], references: [id])
  subscriptionPackageId Int
  user                  User                @relation(fields: [userId], references: [id])
  userId                Int                 @unique
  createdAt             DateTime            @default(now())
  updatedAt             DateTime            @updatedAt
}

model Log {
  id        Int      @id @default(autoincrement())
  context   String   @default("debug")
  level     String
  message   String
  stack     String?
  createdAt DateTime @default(now())
}
